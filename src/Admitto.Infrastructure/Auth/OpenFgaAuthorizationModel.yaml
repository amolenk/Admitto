name: Admitto
model_file: ./OpenFgaAuthorizationModel.fga
tuples:

  - user: system:system
    relation: system
    object: team:team1

  - user: system:system
    relation: system
    object: team:team2

  - user: team:team1
    relation: team
    object: event:eventA

  - user: team:team1
    relation: team
    object: event:eventB

  - user: team:team2
    relation: team
    object: event:eventC

  - user: team:team2
    relation: team
    object: event:eventD

  - user: user:alice
    relation: admin
    object: system:system

  - user: user:bob
    relation: owner
    object: team:team1

  - user: user:bob
    relation: organizer
    object: team:team2

  - user: user:chuck
    relation: organizer
    object: team:team1

  - user: user:chuck
    relation: organizer
    object: event:eventC

  - user: user:chuck
    relation: viewer
    object: event:eventD

tests:

  - name: alice-system
    list_objects:
      - user: user:alice
        type: system
        assertions:
          can_create_team:
            - system:system

  - name: alice-teams
    list_objects:
      - user: user:alice
        type: team
        assertions:
          can_update_team:
            - team:team1
            - team:team2
          can_view_team:
            - team:team1
            - team:team2
          can_create_event:
            - team:team1
            - team:team2

  - name: alice-events
    list_objects:
      - user: user:alice
        type: event
        assertions:
          can_update_event:
            - event:eventA
            - event:eventB
            - event:eventC
            - event:eventD
          can_view_event:
            - event:eventA
            - event:eventB
            - event:eventC
            - event:eventD
  
  - name: bob-teams
    list_objects:
      - user: user:bob
        type: team
        assertions:
          can_update_team:
            - team:team1
          can_view_team:
            - team:team1
            - team:team2
          can_create_event:
            - team:team1
            - team:team2

  - name: bob-events
    list_objects:
      - user: user:bob
        type: event
        assertions:
          can_update_event:
            - event:eventA
            - event:eventB
            - event:eventC
            - event:eventD
          can_view_event:
            - event:eventA
            - event:eventB
            - event:eventC
            - event:eventD
              
  - name: chuck-events
    list_objects:
      - user: user:chuck
        type: event
        assertions:
          can_update_event:
            - event:eventA
            - event:eventB
            - event:eventC
          can_view_event:
            - event:eventA
            - event:eventB
            - event:eventC
            - event:eventD
